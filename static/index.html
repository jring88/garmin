<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garmin Health Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <header>
        <h1>Garmin Health Dashboard</h1>
        <div class="header-actions">
            <span id="sync-status"></span>
            <button id="sync-btn" onclick="triggerSync()">Sync Now</button>
        </div>
    </header>

    <nav class="tabs">
        <button class="active" data-tab="overview">Overview</button>
        <button data-tab="activities">Activities</button>
        <button data-tab="sleep">Sleep</button>
        <button data-tab="body">Body</button>
        <button data-tab="journal">Journal</button>
    </nav>

    <!-- OVERVIEW TAB -->
    <div id="tab-overview" class="tab-panel active">
        <div class="date-range">
            <label>Days: <select id="overview-days" onchange="loadDashboard()">
                <option value="7">7 days</option>
                <option value="14">14 days</option>
                <option value="30" selected>30 days</option>
                <option value="90">90 days</option>
                <option value="365">1 year</option>
                <option value="0">All Time</option>
                <option value="custom">Custom Range</option>
            </select></label>
            <span id="overview-custom-range" style="display:none">
                <label>From <input type="date" id="overview-start" onchange="loadDashboard()"></label>
                <label>To <input type="date" id="overview-end" onchange="loadDashboard()"></label>
            </span>
        </div>
        <div class="summary-cards" id="summary-cards"></div>
        <div class="chart-grid">
            <div class="chart-container chart-full">
                <h3>Activities</h3>
                <canvas id="chart-activities"></canvas>
            </div>
            <div class="chart-container">
                <h3>Sleep Breakdown</h3>
                <canvas id="chart-sleep"></canvas>
            </div>
            <div class="chart-container">
                <h3>Resting Heart Rate</h3>
                <canvas id="chart-hr"></canvas>
            </div>
            <div class="chart-container">
                <h3>Daily Steps</h3>
                <canvas id="chart-steps"></canvas>
            </div>
            <div class="chart-container">
                <h3>Body Battery</h3>
                <canvas id="chart-battery"></canvas>
            </div>
        </div>
    </div>

    <!-- ACTIVITIES TAB -->
    <div id="tab-activities" class="tab-panel">
        <div class="filters">
            <label>Type
                <select id="activity-type-filter" onchange="loadActivities()">
                    <option value="">All</option>
                </select>
            </label>
            <label>From <input type="date" id="activity-start" onchange="loadActivities()"></label>
            <label>To <input type="date" id="activity-end" onchange="loadActivities()"></label>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Duration</th>
                    <th>Distance</th>
                    <th>Avg HR</th>
                    <th>Calories</th>
                    <th>VO2max</th>
                </tr>
            </thead>
            <tbody id="activities-table"></tbody>
        </table>
    </div>

    <!-- SLEEP TAB -->
    <div id="tab-sleep" class="tab-panel">
        <div class="date-range">
            <label>Days: <select id="sleep-days" onchange="loadSleepTab()">
                <option value="14">14 days</option>
                <option value="30" selected>30 days</option>
                <option value="90">90 days</option>
                <option value="365">1 year</option>
                <option value="0">All</option>
            </select></label>
        </div>
        <div class="chart-grid">
            <div class="chart-container chart-full">
                <h3>Sleep Score Trend</h3>
                <canvas id="chart-sleep-score"></canvas>
            </div>
            <div class="chart-container">
                <h3>Average Sleep by Day of Week</h3>
                <canvas id="chart-sleep-dow"></canvas>
            </div>
            <div class="chart-container">
                <h3>Sleep Duration Trend</h3>
                <canvas id="chart-sleep-duration"></canvas>
            </div>
        </div>
    </div>

    <!-- BODY TAB -->
    <div id="tab-body" class="tab-panel">
        <div class="date-range">
            <label>Days: <select id="body-days" onchange="loadBodyTab()">
                <option value="30">30 days</option>
                <option value="90" selected>90 days</option>
                <option value="365">1 year</option>
                <option value="0">All</option>
            </select></label>
        </div>
        <div class="chart-grid">
            <div class="chart-container chart-full">
                <h3>Weight Trend</h3>
                <canvas id="chart-weight"></canvas>
            </div>
            <div class="chart-container">
                <h3>Body Fat %</h3>
                <canvas id="chart-bodyfat"></canvas>
            </div>
            <div class="chart-container">
                <h3>BMI</h3>
                <canvas id="chart-bmi"></canvas>
            </div>
        </div>
    </div>

    <!-- JOURNAL TAB -->
    <div id="tab-journal" class="tab-panel">
        <div class="journal-form" id="journal-form">
            <h3 id="journal-form-title">New Entry</h3>
            <input type="hidden" id="journal-edit-id">
            <div class="form-row">
                <label>Date <input type="date" id="journal-date"></label>
                <label>Category
                    <select id="journal-category">
                        <option value="general">General</option>
                        <option value="mood">Mood</option>
                        <option value="nutrition">Nutrition</option>
                        <option value="injury">Injury</option>
                        <option value="goal">Goal</option>
                    </select>
                </label>
                <label>Rating (1-10) <input type="number" id="journal-rating" min="1" max="10"></label>
            </div>
            <div class="form-row">
                <label style="flex:3">Content <textarea id="journal-content"></textarea></label>
            </div>
            <div class="form-row">
                <label>Tags (comma-separated) <input type="text" id="journal-tags" placeholder="running, fatigue"></label>
            </div>
            <div style="display:flex;gap:0.5rem">
                <button onclick="saveJournal()">Save</button>
                <button class="secondary" onclick="resetJournalForm()">Cancel</button>
            </div>
        </div>
        <div class="journal-entries" id="journal-entries"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4"></script>
    <script src="/app.js"></script>
</body>
</html>
